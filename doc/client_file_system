File System:

root_dir
|-- conversations
|   |-- <conversationName>
|   |   |-- metadata 
|   |   |-- <messageName>
|   |   |-- (other messages in the conversation)
|   |-- (other conversations)
|-- outbox
|   |-- <conversationName> (for every existing conversation in the conversations list)
|   |   |-- metadata (a copy of the one in the conversations list, not a symlink)
|   |-- <conversationName> (might or might not match an existing conversation in the conversations directory
|   |   |-- metadata (TODO: ...actually do we need different data here than in an existing conversation?)
|   |   |-- <messageName> (message to send, TODO: should this be a different format than the other message name?)
|   |   |-- (other messages to send)
|-- contacts
|   |-- <user>
|   |-- (other users)
|-- tmp
|-- keys

Details:
-- <conversationName> is "date-number-sender-recipient-recipient-..."
   |-- date is the date of the first message in the conversation in the format YYYY-MM-DDTHH:MM:SS
   |-- sender/recipient are the dename names of these users represented in a reduced character set (see docs/username_character_set)
   |-- The recipient list is sorted alphabetically but omits the user's address
   |-- number is the minimum non-negative integer that avoids a naming conflict with another conversation. (Note that since dename names can contain hyphens two conversations with different sets of participants can have naming conflicts. Also note that conversations can be deleted so there could be a conversation with number 1 without any conversation number 0. The name of this folder is meant to provide a brief description of its contents; it should not be parsed for metadata.)
-- metadata is a file containing metadata for the conversation
   |-- TODO: details on what the metadata file contains + what structure (definitely includes a participant list, message type, optional subject)
   |-- TODO: we might end up using an official protobuf metadata file augmented by a secondary metadata file that will be easier for external scripts to parse
-- <messageName> is "date-number-sender", optionally followed by an extension ".<EXT>". The contacts are the message body.
   |-- see details under conversationName
-- tmp is a folder for temporary files. Its contents may be deleted at any time without consequence. It is primarily used for making file system writes atomic (i.e. write a message file in tmp then atomically move it elsewhere)
-- keys contains ratchet keys for contacts
   |-- TODO: details on structure within this folder
-- <user> is "username-number" (a dename username with a reduced character set followed by the minimum non-negative integer to ensure uniqueness). The file contains the user's dename record and optionally a local alias. TODO: format?

TODO:
-- user data for the local user: dename record, etc
-- location for UIs to store their local data (i.e. signature, auto-reply rules, filters, etc)
